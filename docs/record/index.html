<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <meta name="description" content="Introduction to Menus">

        <meta property="og:site_name" content="Laravel USSD"/>
        <meta property="og:title" content="Record | Laravel USSD"/>
        <meta property="og:description" content="Introduction to Menus"/>
        <meta property="og:url" content="https://sparors.github.io/ussd-docs/docs/record"/>
        <meta property="og:image" content="/ussd-docs/assets/img/logo.png"/>
        <meta property="og:type" content="website"/>

        <meta name="twitter:image:alt" content="Laravel USSD">
        <meta name="twitter:card" content="summary_large_image">

                    <meta name="generator" content="tighten_jigsaw_doc">
        
        <title>Laravel USSD | Record</title>

        <link rel="home" href="https://sparors.github.io/ussd-docs">
        <link rel="icon" href="/ussd-docs/favicon.ico">

        
                    <!-- Insert analytics code here -->
        
        <link href="https://fonts.googleapis.com/css2?family=Raleway:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="/ussd-docs/assets/build/css/main.css?id=36bd75733674d1919eaa">

                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
            </head>

    <body class="flex flex-col justify-between min-h-screen bg-gray-100 text-gray-800 leading-normal font-sans">
        <header class="flex items-center shadow bg-white border-b h-24 mb-8 py-4" role="banner">
            <div class="container flex items-center max-w-8xl mx-auto px-4 lg:px-8">
                <div class="flex items-center">
                    <a href="/ussd-docs/" title="Laravel USSD home" class="inline-flex items-center">
                        <img class="h-8 md:h-10 mr-3" src="/ussd-docs/assets/img/logo.svg" alt="Laravel USSD logo" />

                        <h1 class="text-lg md:text-2xl text-blue-900 font-semibold hover:text-blue-600 my-0 pr-4">Laravel USSD</h1>
                    </a>
                </div>

                <div class="flex flex-1 justify-end items-center text-right md:pl-10">
                                            <button
    title="Start searching"
    type="button"
    class="flex md:hidden bg-gray-100 hover:bg-blue-100 justify-center items-center border border-gray-500 rounded-full focus:outline-none h-10 px-3"
    onclick="searchInput.toggle()"
>
    <img src="/assets/img/magnifying-glass.svg" alt="search icon" class="h-4 w-4 max-w-none">
</button>

<div id="js-search-input" class="docsearch-input__wrapper hidden md:block">
    <label for="search" class="hidden">Search</label>

    <input
        id="docsearch-input"
        class="docsearch-input relative block h-10 transition-fast w-full lg:w-1/2 xl:w-1/3 bg-gray-100 outline-none rounded-full text-gray-700 border border-gray-500 focus:border-blue-400 ml-auto px-4 pb-0"
        name="docsearch"
        type="text"
        placeholder="Search"
    >

    <button
        class="md:hidden absolute pin-t pin-r h-full font-light text-3xl text-blue-500 hover:text-blue-600 focus:outline-none -mt-px pr-7"
        onclick="searchInput.toggle()"
    >&times;</button>
</div>

                                    </div>
            </div>

                <button class="flex justify-center items-center bg-blue-500 border border-blue-500 h-10 mr-4 px-5 rounded-full lg:hidden focus:outline-none"
    onclick="navMenu.toggle()"
>
    <svg id="js-nav-menu-show" xmlns="http://www.w3.org/2000/svg"
        class="fill-current text-white h-9 w-4" viewBox="0 0 32 32"
    >
        <path d="M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"/>
    </svg>

    <svg id="js-nav-menu-hide" xmlns="http://www.w3.org/2000/svg"
        class="hidden fill-current text-white h-9 w-4" viewBox="0 0 36 30"
    >
        <polygon points="32.8,4.4 28.6,0.2 18,10.8 7.4,0.2 3.2,4.4 13.8,15 3.2,25.6 7.4,29.8 18,19.2 28.6,29.8 32.8,25.6 22.2,15 "/>
    </svg>
</button>

        </header>

        <main role="main" class="w-full flex-auto">
            <section class="container max-w-8xl mx-auto px-6 md:px-8 py-4">
    <div class="flex flex-col lg:flex-row">
        <nav id="js-nav-menu" class="nav-menu hidden lg:block">
            <ul class="my-0">
            <li class="pl-4">
            
        <p class="nav-menu__item text-gray-600">GETTING STARTED</p>
    
            
        <ul class="my-0">
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/requirements"
            class="lvl1   nav-menu__item hover:text-blue-500"
        >
            Requirements
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/installation"
            class="lvl1   nav-menu__item hover:text-blue-500"
        >
            Installation
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/questions-issues"
            class="lvl1   nav-menu__item hover:text-blue-500"
        >
            Questions and Issues
        </a>
    
    </li>
    </ul>
    </li>
            <li class="pl-4">
            
        <p class="nav-menu__item text-gray-600">CORE CONCEPTS</p>
    
            
        <ul class="my-0">
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/state"
            class="lvl1   nav-menu__item hover:text-blue-500"
        >
            State
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/menu"
            class="lvl1   nav-menu__item hover:text-blue-500"
        >
            Menu
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/action"
            class="lvl1   nav-menu__item hover:text-blue-500"
        >
            Action
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/decision"
            class="lvl1   nav-menu__item hover:text-blue-500"
        >
            Decision
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/record"
            class="lvl1  active font-semibold text-blue-500 nav-menu__item hover:text-blue-500"
        >
            Record
        </a>
    
    </li>
            <li class="pl-4">
            
        <a href="/ussd-docs/docs/machine"
            class="lvl1   nav-menu__item hover:text-blue-500"
        >
            Machine
        </a>
    
    </li>
    </ul>
    </li>
    </ul>
        </nav>

        <div class="DocSearch-content w-full lg:w-3/5 break-words pb-16 lg:pl-4" v-pre>
            <h1 id="record">Record</h1>

<p>Every new session has different a session id. Record helps to save data for a 
particular request since it ties it self with the request id. Data can be 
saved on any state and retrieved on another state provided they 
have the same session id.</p>

<h2 id="record-how">How it works?</h2>

<p>Record connects with the cache of your choice and saves the data to cache. 
Since caches are faster than databases, they help to speed up the response 
time of ussd applications since the ussd gateway timeout if response delays. 
The unique identifier to your store is the session id, when it is not set, 
an exception will be thrown.</p>

<h2 id="record-why">Why the need for record?</h2>

<p>It is impossible to collect data from users with just a state. You will have 
to have a series of states presented as a form that the user can fill. 
Data collected will have to be saved and used at a later date, 
hence the need for the record.</p>

<h2 id="record-manipulating-data">Manipulating Data</h2>

<p>The ussd state class has a property <code>$record</code> which is an instance 
of <code>Sparors\Ussd\Record</code> class. This will help you save, update, 
retrieve or delete data when the need arises.</p>

<h3 id="record-saving-data">Saving Data</h3>

<p>To save data use the set method of the record class.</p>

<pre><code class="language-php">$this-&gt;record-&gt;set('name', 'Benjamin');
</code></pre>

<h4 id="record-saving-multiple">Saving Multiple Data</h4>

<p>To save multiple data at onces use the setMuliple</p>

<pre><code class="language-php">$this-&gt;record-&gt;setMultiple(['name' =&gt; 'Isaac', 'age' =&gt; 17, 'amount' =&gt; 3.50]);
</code></pre>

<h4 id="record-auto-expire">Automatic Expiration</h4>

<p>Sometimes, you don't want your cache to be filled with state data.
You will want to automatically delete the old data.
Set the expiration time you want in seconds.</p>

<pre><code class="language-php">$this-&gt;record-&gt;set('name' =&gt; 'Isaac', 86400); // One day in seconds
</code></pre>

<p>You can also use datetime instead</p>

<pre><code class="language-php">$this-&gt;record-&gt;setMultiple(['name' =&gt; 'Isaac', 'age' =&gt; 17, 'amount' =&gt; 3.50], now()-&gt;addDays(7));
</code></pre>

<h4 id="record-save-magic">Saving Data with Magic Method</h4>

<p>You can dynamically save data with record by assigning values to a property.
The property name will become the key used to save the value in the cache.</p>

<pre><code class="language-php">// single value
$this-&gt;record-&gt;name = 'Timothy';

// multiple values
$this-&gt;record(['name' =&gt; 'Timothy', 'age' =&gt; 17]);
</code></pre>

<blockquote>
  <p>NB: The TTL of magic methods are taken from <code>config/ussd.php</code>.
  <a href="../installation#installation-config-understanding">See</a></p>
</blockquote>

<h4 id="record-save-update">Updating Data</h4>

<p>When you set a record that already exists, the value is overwritten in the cache.</p>

<pre><code class="language-php">$this-&gt;record-&gt;set('name', 'Tom');

$this-&gt;record-&gt;set('name', 'Jerry'); // Tom will update to Jerry.
</code></pre>

<h3 id="record-has-data">Check Data Exist</h3>

<p>To check if a record is set and not null, use the has method</p>

<pre><code class="language-php">if ($this-&gt;record-&gt;has('name')) {
    echo "Name Already Set";
} else {
    echo "Name Not Set";
}
</code></pre>

<h3 id="record-retrieve-data">Retrieve Data</h3>

<p>Use the get method to retrieve saved data. Null will be returned when key not found</p>

<pre><code class="language-php">$name = $this-&gt;record-&gt;get('name');
</code></pre>

<h4 id="record-retrieve-multiple">Retrieve Multiple Data</h4>

<p>You can retrieve more than one day at a go.</p>

<pre><code class="language-php">[$name, $age] = $this-&gt;record-&gt;getMultiple(['name', 'age']);
</code></pre>

<h4 id="record-retrieve-default">Setting default</h4>

<p>Sometimes, you want to get something else when data can not be found instead of null. You can set the default value.</p>

<pre><code class="language-php">$name = $this-&gt;record-&gt;get('name', 'Ussd User');

[$balanceBefore, $balanceAfter] = $this-&gt;record-&gt;getMultiple(['balance_before', 'balance_after'], 0.00);
</code></pre>

<h4 id="record-retrieve-magic">Retrieve Data with magic method</h4>

<p>You can retrieve data with magic methods using the key of value
as the property of record.</p>

<pre><code class="language-php">$name = $this-&gt;record-&gt;name;

// or 

$age = $this-&gt;record('age');
</code></pre>

<blockquote>
  <p>NB: The default value of magic methods are taken from <code>config/ussd.php</code>.
  <a href="../installation#installation-config-understanding">See</a></p>
</blockquote>

<h3 id="record-delete-data">Deleting Data</h3>

<p>To delete single records use the delete method</p>

<pre><code class="language-php">$this-&gt;record-&gt;delete('name');
</code></pre>

<h4 id="record-delete-multiple">Delete Multiple Data</h4>

<p>To delete more than one at a time, use setMultiple</p>

<pre><code class="language-php">$this-&gt;record-&gt;deleteMultiple(['name', 'age']);
</code></pre>
        </div>
    </div>
</section>
        </main>

        <script src="/ussd-docs/assets/build/js/main.js?id=8b1f137f16842f6fe7d3"></script>

        <script>
    const navMenu = {
        toggle() {
            const menu = document.getElementById('js-nav-menu');
            menu.classList.toggle('hidden');
            menu.classList.toggle('lg:block');
            document.getElementById('js-nav-menu-hide').classList.toggle('hidden');
            document.getElementById('js-nav-menu-show').classList.toggle('hidden');
        },
    }
</script>
            <script type="text/javascript">
            docsearch({
                apiKey: '74d3945d9e6d08bcb8cd48fe58d4a948',
                indexName: 'sparors_ussd',
                inputSelector: '#docsearch-input',
                debug: false // Set debug to true if you want to inspect the dropdown
            });

            const searchInput = {
                toggle() {
                    const menu = document.getElementById('js-search-input');
                    menu.classList.toggle('hidden');
                    menu.classList.toggle('md:block');
                    document.getElementById('docsearch-input').focus();
                },
            }
        </script>
    
        <footer class="bg-white text-center text-sm mt-12 py-4" role="contentinfo">
            <ul class="flex flex-col md:flex-row justify-center">
                <li class="md:mr-2">
                    &copy; <a href="https://sparors.github.io" title="Sparors website">Sparors</a> 2020.
                </li>

                <li>
                    Built with <a href="http://jigsaw.tighten.co" title="Jigsaw by Tighten">Jigsaw</a>
                    and <a href="https://tailwindcss.com" title="Tailwind CSS, a utility-first CSS framework">Tailwind CSS</a>.
                </li>
            </ul>
        </footer>
    </body>
</html>
